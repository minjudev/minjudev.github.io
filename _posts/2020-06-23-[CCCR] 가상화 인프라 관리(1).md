# Virtualization 개요
## 가상화 개념
### 1. 가상화란?
- 물리적인 하드웨어 장치를 논리적인 객체로 추상화하는 것   
- 하나의 하드웨어를 여러 장치처럼 동작시키거나 여러 장치를 하나의 하드웨어처럼 사용자에게 제공할 수 있는 것   
[출처 - 가상화란 무엇인가?](https://kim-dragon.tistory.com/5)
- 가상 시스템은 서로 독립적
- 리소스의 효율적 사용 가능
- 서버의 쉽고 빠른 배포
- 중앙집중화된 가상화 인프라 구성 가능
- 하이퍼바이저
  - 호스트 컴퓨터에서 다수의 운영체제를 동시에 실행하기 위한 논리적 플랫폼
  - 가상화의 관리 및 지원
- 호스트: 물리적인 시스템
- 게스트: 하이퍼바이저 상에서 실행되는 가상머신

### 1 - 1) 전 가상화(Full Virtualization)
- 가상머신이 제공받은 하드웨어가 전부 가상의 하드웨어
- 전 가상화로 만들어진 가상머신은 자신이 가상머신인지 알지 못함
- 물리적인 하드웨어에 접근할 때 하이퍼바이저에 의해 제어됨
- 하이퍼바이저는 가상머신들의 각기 다른 명령을 해석해서 하드웨어에 전달
- 전 가상화는 트랩과 에뮬레이트 작업을 거치므로 성능이 떨어짐
- 대부분의 운영체제를 쉽게 설치 가능
- 장점: 기존 운영체제를 수정 없이 사용 가능

### 1 - 2) 반 가상화(Para-Virtualization)
- 운영체제의 커널 소스를 수정한 가상화
- 하이퍼바이저가 가상머신에게 특수한 인터페이스 제공
- 반 가상화는 전 가상화보다 오버헤드(어떤 처리를 하기 위해 들어가는 간접적인 처리 시간)가 적음
- 운영체제의 커널 소스를 수정해야 하므로 오픈소스 운영체제로 한정
- 운영체제가 하이퍼바이저가 알아들을 수 있는 명령을 바로 내림

### 2. 하이퍼바이저(Hypervisor)
- 가상화를 구현하기 위한 기반이 되는 기술
- 각 가상머신에서 수행하는 명령을 해석해 하드웨어가 올바른 동작을 할 수 있게 중재하는 역할
- 하드웨어를 소프트웨어적으로 파티셔닝하여 가상머신에게 제공
- 가상화에서는 독립성 유지가 매우 중요   
- 주요 기능: 시스템 자원 관리, 모니터링, 독립성 유지, 주변 장치 제공   
[출처 - 하이퍼바이저, 전가상화, 반가상화](https://itholic.github.io/hypervisor/)

![Untitled Diagram](https://user-images.githubusercontent.com/53208493/85394607-c6e0f500-b589-11ea-8555-90c3897e0dce.png)

### 2 - 1) Native/Bare-metal Hypervisor(Type 1)
- 물리적인 머신에 하이퍼바이저 소프트웨어를 설치
- 하이퍼바이저가 해당 하드웨어 위에서 직접 실행됨
- 별도의 운영체제가 필요 없음
- 하이퍼바이저를 관리할 시스템이 존재해야 함

### 2 - 2) Hosted Hypervisor(Type 2)
- 운영체제가 설치된 머신에서 하이퍼바이저 소프트웨어를 설치
- 하이퍼바이저는 일반 프로그램과 같이 호스트 운영체제에서 실행됨
- 하이퍼바이저를 관리할 시스템이 존재하지 않아도 됨

### 3. 클라우드 컴퓨팅
- 가상화는 클라우드 컴퓨팅의 기본 토대를 제공
- 가상화와 클라우드 컴퓨팅은 서로 별개
- 가상화는 특정 응용프로그램에 사용할 리소스가 한정적일 경우 적합

### 가상화와 클라우드 컴퓨팅 비교
|가상화|클라우드|
|:-----:|:--------:|
|개별 물리적 시스템에 대해 여러 개의 가상환경을 생성|온디맨드 사용을 위한 가상 리소스 풀링과 자동화|
|자원의 장기적 할당|단기 자원 배분|
|stateful|stateless|
|인프라 수준의 고가용성|응용 프로그램 계층에서의 고가용성|
|Scales up(수직 확장: 크기의 증가)|Scales out(수평 확장: 개수의 증가)|

### 4. oVirt
- Host와 Guest 시스템을 중앙에서 관리하는 가상화 플랫폼(PaaS)
- oVirt에서 제공하는 기능
  - hardware node 관리
  - 스토리지 및 네트워크 자원 관리
  - 가상머신 배포 및 관리
  - 마이그레이션 및 고가용성
  - 시스템 스케줄링 및 파워 관리
  - 각 노드 및 전체적인 플랫폼 모니터링

### KVM(Kernel-based Virtual Machine)
  - 커널과 직접적으로 통합된 하이퍼바이저
  - Native 하이퍼바이저 호스트에서 커널이 하이퍼바이저 역할을 하도록 함
  - **Thin Hypervisor Host**
    - Native(또는 Bare-metal)형 하이퍼바이저
    - Host 시스템에서는 어떤 서비스도 제공되어선 안됨(ssh 제외)
    - Host 시스템은 가상화 관리를 위해서만 사용
    - Guest 시스템은 애플리케이션 및 서비스 제공
    - Host 시스템 자체가 불안정하거나 공격 받으면 Guest에 영향
  - **Thick Hypervisor Host**
    - Hosted형 하이퍼바이저
    - Host 시스템의 운영체제에 하이퍼바이저 소프트웨어를 설치해 사용
    - Guest 시스템을 설치하기가 쉬움
    - 개발, 테스트, 시연, 강의 용도로 사용하기에 적당
  - KSM(Kernel Same-page Merging)
    - KVM의 메모리 관리 기법
    - Host 시스템에서 Guest OS가 동일하면 메모리의 페이지를 공유
  - 장치 모델(Device Model)
    - Guest가 실제 H/W에 접근하는 것은 불가능
    - 실제 H/W와 같은 역할을 할 가상의 H/W 필요
    - Guest에 에뮬레이트된 가상의 H/W 제공
    - QEMU를 통한 H/W 에뮬레이트
  - VirtIO(Virtualization Input/Output)
    - 에뮬레이트된 가상의 H/W는 실제 H/W보다 성능이 좋지 않음
    - 반 가상화 I/O 장치를 Guest에게 부여 -> 성능 향상
    - 이를 위해 Guest 시스템에서 추가 드라이버를 설치해야 함
    
## oVirt 구성 요소
### 1. 엔진(Engine)
### 2. 호스트(Hosts)
### 3. 스토리지 저장소(Storage)
### 4. 데이터 웨어하우스(Data Warehouse)
### 5. 네트워크(Network in RHV)

